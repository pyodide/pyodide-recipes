From e0a3b82e32470425818624662308a74fc88f9f8b Mon Sep 17 00:00:00 2001
From: Agriya Khetarpal <74401230+agriyakhetarpal@users.noreply.github.com>
Date: Fri, 9 May 2025 18:15:47 +0530
Subject: [PATCH] Keep AddIdentity alive

---
 external_packages/casadi-sundials/sundials/sundials_direct.c | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/external_packages/casadi-sundials/sundials/sundials_direct.c b/external_packages/casadi-sundials/sundials/sundials_direct.c
index 0fabca62c..3bc3cffba 100644
--- a/external_packages/casadi-sundials/sundials/sundials_direct.c
+++ b/external_packages/casadi-sundials/sundials/sundials_direct.c
@@ -252,7 +252,9 @@ void destroyArray(void *v)
 }
 
 
-void AddIdentity(DlsMat A)
+#ifdef __EMSCRIPTEN__
+#include <emscripten.h>
+void EMSCRIPTEN_KEEPALIVE AddIdentity(DlsMat A)
 {
   long int i;
 
@@ -269,6 +271,7 @@ void AddIdentity(DlsMat A)
   }
 
 }
+#endif
 
 
 void SetToZero(DlsMat A)
-- 
2.39.5 (Apple Git-154)

